{% extends 'base.html' %}
{% load i18n static %}

{% block content %}
<div class="mx-4 sm:mx-6 lg:mx-8 p-6 w-full">

    <h1 class="text-2xl font-bold mb-6">{% trans "Marques de voiture" %}</h1>

    <!-- Favoris -->
    <div id="favoris-section"
         class="mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4 {% if not favoris %}hidden{% endif %}">
        <h2 class="font-semibold text-yellow-600 mb-2">⭐ {% trans "Mes marques favorites" %}</h2>
        <div id="favoris-list" class="flex flex-wrap gap-4">
            {% for marque in favoris %}
                <div class="flex items-center gap-2" data-marque-id="{{ marque.id_marque }}">
                    <span>{{ marque.nom_marque }}</span>
                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="blue" stroke="currentColor" stroke-width="2">
                        <path d="M11.48 3.5a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442a.562.562 0 01.32.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0l-4.725 2.885a.562.562 0 01-.84-.61l1.285-5.385a.563.563 0 00-.182-.557l-4.204-3.602a.562.562 0 01.32-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z"/>
                    </svg>
                </div>
            {% endfor %}
        </div>
    </div>

    <!-- Recherche -->
   <div class="mb-6">
        <input
            type="text"
            id="search-exemplaire"
            class="border rounded-lg px-4 py-2 w-full"
            placeholder="{% trans 'Rechercher une marque...' %}"
        >
    </div>

    <!-- Marques -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        {% for marque in marques %}
        <div class="bg-white shadow-md hover:shadow-lg transition rounded-lg p-6 marque-card
                    flex items-center gap-6 cursor-pointer w-full"
             onclick="window.location.href='{% url 'voiture_marque:modeles_par_marque' marque_id=marque.id_marque %}'"
             data-marque-id="{{ marque.id_marque }}"
             data-marque-nom="{{ marque.nom_marque|lower }}">

            <div class="flex-1">
                <h2 class="text-lg font-semibold">{{ marque.nom_marque }}</h2>
                <p class="text-gray-600">{% trans "Voir les modèles de cette marque" %}</p>
            </div>

            <img src="{% static 'images/marques/' %}{{ marque.nom_marque|lower }}.png"
                 class="w-[65px] h-[65px] object-contain"
                 onerror="this.src='{% static 'images/marques/default.png' %}'">
        </div>
        {% endfor %}
    </div>

</div>

<script src="{% static 'js/jquery-3.6.0.min.js' %}"></script>

<script>
(function(){
  const input = document.getElementById("search-marque");
  if(!input) return;

  input.addEventListener("input", function(){
      const value = this.value.trim().toLowerCase();
      const cards = document.querySelectorAll(".marque-card");

      cards.forEach(card => {
          const nom = (card.dataset.marqueNom || "").toLowerCase();
          card.style.display = (!value || nom.startsWith(value)) ? "flex" : "none";
      });
  });
})();
</script>

{% endblock %}
