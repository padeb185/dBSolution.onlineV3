{% extends "base.html" %}
{% load i18n static %}

{% block content %}
<div class="max-w-xl mx-auto p-6 bg-white rounded shadow mt-16 mb-16">

    <h1 class="text-2xl font-bold mb-4 text-center flex items-center justify-center">
         <img src="{% static 'icons/disque-de-frein.png' %}" alt="freins"
             style="width:60px; height:60px; margin-right:10px;">
        {% trans "Ajouter un système de freinage arrière" %}
    </h1>

    {% for message in messages %}
        <div class="mb-3 text-red-600">{{ message }}</div>
    {% endfor %}

    <form method="post" class="flex flex-col space-y-4">
        {% csrf_token %}

        <div>
            <label for="id_marque_disques_ar">{% trans "Marque disques arrière" %}</label>
            <input type="text" id="id_marque_disques_ar" name="marque_disques_ar" class="border rounded px-4 py-2 w-full">
        </div>

        <div>
            <label for="id_taille_disques_ar">{% trans "Diamètre disques arrière (mm)" %}</label>
            <input type="text" id="id_taille_disques_ar" name="taille_disques_ar" class="border rounded px-4 py-2 w-full">
        </div>

        <div>
            <label for="id_epaisseur_disques_ar">{% trans "Épaisseur disques arrière (mm)" %}</label>
            <input type="text" id="id_epaisseur_disques_ar" name="epaisseur_disques_ar" class="border rounded px-4 py-2 w-full">
        </div>

        <div>
            <label for="id_epaisseur_min_disque_ar">{% trans "Épaisseur minimum disques arrière (mm)" %}</label>
            <input type="text" id="id_epaisseur_min_disque_ar" name="epaisseur_min_disque_ar" class="border rounded px-4 py-2 w-full">
        </div>

        <div>
            <label for="id_plaquettes_ar">{% trans "Épaisseur plaquettes arrière (mm)" %}</label>
            <input type="text" id="id_plaquettes_ar" name="plaquettes_ar" class="border rounded px-4 py-2 w-full">
        </div>

        <div>
            <label for="id_marque_plaquettes_ar">{% trans "Marque plaquettes arrière" %}</label>
            <input type="text" id="id_marque_plaquettes_ar" name="marque_plaquettes_ar" class="border rounded px-4 py-2 w-full">
        </div>

        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded w-full hover:bg-blue-700 transition">
            {% trans "Ajouter" %}
        </button>
    </form>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const decimalInputs = [
        "id_taille_disques_ar",
        "id_epaisseur_disques_ar",
        "id_epaisseur_min_disque_ar",
        "id_plaquettes_ar"
    ];

    decimalInputs.forEach(id => {
        const input = document.getElementById(id);
        if (!input) return;

        input.placeholder = "XXX,XX";

        input.addEventListener("input", function () {
            // Remplace point par virgule
            this.value = this.value.replace(".", ",");

            // Supprime caractères non valides
            this.value = this.value.replace(/[^0-9,]/g, "");

            // Une seule virgule autorisée
            const parts = this.value.split(",");
            if (parts.length > 2) {
                this.value = parts[0] + "," + parts[1];
            }

            // Limite à 2 décimales
            if (parts[1]?.length > 2) {
                this.value = parts[0] + "," + parts[1].slice(0, 2);
            }
        });
    });
});
</script>

{% endblock %}
