{% load static i18n widget_tweaks %}
{% get_current_language as LANGUAGE_CODE %}

<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>{% block title %}{% trans "dBSolution" %}{% endblock %}</title>

        <!-- CSS principal compilé -->
        <link rel="stylesheet" href="{% static 'theme/css/dist/styles.css' %}">


        <link rel="icon" type="image/png" href="{% static 'images/favicon.ico' %}">
    </head>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <!-- DataTables JS & CSS -->
        <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>

    <body class="{% block body_class %}bg-pastelblue min-h-screen flex flex-col mr-[70px]{% endblock %}">

        {% block header %}
        <header class="bg-white shadow p-4">
            <nav class="container mx-auto flex flex-col md:flex-row justify-between items-center gap-4 md:gap-0">
                <div class="flex gap-4 items-center">
                    <a href="{% url 'home' %}" class="text-gray-600 hover:text-black font-semibold transition duration-300">{% trans "Accueil" %}</a>
                    <a href="{% url 'utilisateurs:dashboard' %}" class="text-gray-600 hover:text-black font-semibold transition duration-300">{% trans "Tableau de Bord" %}</a>
                </div>

                <form action="{% url 'set_language' %}" method="post" class="flex items-center gap-2 mt-2 md:mt-0">
                    {% csrf_token %}
                    <input type="hidden" name="next" value="{{ request.path }}">
                    <select name="language" class="border rounded p-1 focus:ring-2 focus:ring-blue-500 focus:outline-none">
                        {% get_available_languages as LANGUAGES %}
                        {% for code, name in LANGUAGES %}
                            <option value="{{ code }}" {% if code == LANGUAGE_CODE %}selected{% endif %}>{{ name }}</option>
                        {% endfor %}
                    </select>
                    <button type="submit" class="bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700 transition duration-300">
                        {% trans "Changer" %}
                    </button>
                </form>
            </nav>
        </header>
        {% endblock %}

        <main class="{% block main_class %}container mx-auto mt-8 p-6 flex-1 flex flex-col gap-6{% endblock %}">
            {% block content %}{% endblock %}
        </main>

        {% block footer %}
            <footer class="bg-white shadow p-4 mt-auto text-gray-500 flex items-center justify-between">

                <!-- Bouton Retour à gauche -->
                <div class="flex-shrink-0">
                    <button type="button"
                            onclick="history.back()"
                            class="bg-blue-600 text-white px-3 py-1 rounded hover:bg-gray-600 transition duration-300">
                        {% trans "Retour" %}
                    </button>
                </div>

                <!-- Texte centré -->
                <div class="flex-1 text-center">
                    &copy; {{ now|date:"Y" }} dBSolution. {% trans "Tous droits réservés." %}
                </div>

                <!-- Bouton Déconnexion à droite -->
                <div class="flex-shrink-0">
                    {% if request.user.is_authenticated %}
                        <form action="{% url 'utilisateurs:logout' %}" method="post">
                            {% csrf_token %}
                            <button type="submit"
                                    class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 transition duration-300">
                                {% trans "Déconnexion" %}
                            </button>
                        </form>
                    {% endif %}
                </div>

            </footer>
        {% endblock %}



        <!-- DUMMY POUR SAFELIST DES CLASSES DYNAMIQUES -->
        <div class="hidden bg-red-500 bg-blue-600 hover:bg-blue-700 text-gray-700 text-gray-500 border border-gray-300 px-4 py-2 rounded shadow-md flex flex-col items-center justify-center min-h-screen w-full"></div>

    </body>
</html>
