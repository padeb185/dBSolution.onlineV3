{% extends "base.html" %}
{% load i18n static %}

{% block content %}
<div class="max-w-xl mx-auto p-6 bg-white rounded shadow mt-16 mb-16">

    <h1 class="text-2xl font-bold mb-4 text-center flex items-center justify-center">
        <img src="{% static 'icons/disque-de-frein.png' %}" alt="freins avant"
             style="width:60px; height:60px; margin-right:10px;">
        {% trans "Ajouter un système de freinage avant" %}
    </h1>

     {% if messages %}
        {% for message in messages %}
        <div class="mb-3 px-4 py-2 rounded
            {% if message.tags == 'success' %}
                bg-green-100 text-green-800 border border-green-300
            {% else %}
                bg-red-100 text-red-800 border border-red-300
            {% endif %}">
            {{ message }}
        </div>
        {% endfor %}
    {% endif %}

    <form method="post" class="flex flex-col space-y-4">
        {% csrf_token %}

        <div>
            <label for="id_marque_disques_av">{% trans "Marque disques avant" %}</label>
            <input type="text" id="id_marque_disques_av" name="marque_disques_av" class="border rounded px-4 py-2 w-full">
        </div>

        <div>
            <label for="id_taille_disque_av">{% trans "Diamètre disques avant (mm)" %}</label>
            <input type="text" id="id_taille_disque_av" name="taille_disque_av" class="border rounded px-4 py-2 w-full">
        </div>

        <div>
            <label for="id_epaisseur_disque_av">{% trans "Épaisseur disques avant (mm)" %}</label>
            <input type="text" id="id_epaisseur_disque_av" name="epaisseur_disque_av" class="border rounded px-4 py-2 w-full">
        </div>

        <div>
            <label for="id_epaisseur_min_disque_av">{% trans "Épaisseur minimum disques avant (mm)" %}</label>
            <input type="text" id="id_epaisseur_min_disque_av" name="epaisseur_min_disque_av" class="border rounded px-4 py-2 w-full">
        </div>

        <div>
            <label for="id_marque_plaquettes_av">{% trans "Marque plaquettes avant" %}</label>
            <input type="text" id="id_marque_plaquettes_av" name="marque_plaquettes_av" class="border rounded px-4 py-2 w-full">
        </div>

        <div>
            <label for="id_plaquettes_av">{% trans "Épaisseur plaquettes avant (mm)" %}</label>
            <input type="text" id="id_plaquettes_av" name="plaquettes_av" class="border rounded px-4 py-2 w-full">
        </div>



        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded w-full hover:bg-blue-700 transition">
            {% trans "Ajouter" %}
        </button>
    </form>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const decimalInputs = [
        "id_taille_disque_av",
        "id_epaisseur_disque_av",
        "id_epaisseur_min_disque_av",
        "id_plaquettes_av"
    ];

    decimalInputs.forEach(id => {
        const input = document.getElementById(id);
        if (!input) return;

        input.placeholder = "XXX,X";

        input.addEventListener("input", function () {
            // Remplace point par virgule
            this.value = this.value.replace(".", ",");

            // Supprime caractères non valides
            this.value = this.value.replace(/[^0-9,]/g, "");

            // Une seule virgule autorisée
            const parts = this.value.split(",");
            if (parts.length > 2) {
                this.value = parts[0] + "," + parts[1];
            }

            // Limite à 2 décimales
            if (parts[1]?.length > 2) {
                this.value = parts[0] + "," + parts[1].slice(0, 2);
            }
        });
    });
});
</script>
{% endblock %}
